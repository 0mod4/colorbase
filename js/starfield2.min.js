var Star=function(t,i,e){this.x=t,this.y=i,this.slope=i/t,this.opacity=0,this.speed=Math.max(Math.random()*e,1)};Star.prototype.distanceTo=function(t,i){return Math.sqrt(Math.pow(t-this.x,2)+Math.pow(i-this.y,2))},Star.prototype.resetPosition=function(){return Star.apply(this,arguments),this};var StarFactory={getRandomStar:function(t,i,e,a,n){var s=StarFactory.getRandomPosition(t,i,e,a);return new Star(s.x,s.y,n)},getRandomPosition:function(t,i,e,a){return{x:Math.floor(Math.random()*e+t),y:Math.floor(Math.random()*a+i)}}},StarField=function(t){this.container=document.getElementById(t),this.canvasElem=this.container.getElementsByTagName("canvas")[0],this.canvas=this.canvasElem.getContext("2d"),this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.starField=[]};StarField.prototype._updateStarField=function(){var t,i,e,a;for(t=0;t<this.numStars;t++)i=this.starField[t],a=Math.min(i.speed,Math.abs(i.speed/i.slope)),i.x+=i.x>0?a:-a,i.y=i.slope*i.x,i.opacity+=i.speed/100,(Math.abs(i.x)>this.width/2||Math.abs(i.y)>this.height/2)&&(e=StarFactory.getRandomPosition(-this.width/10,-this.height/10,this.width/5,this.height/5),i.resetPosition(e.x,e.y,this.maxStarSpeed))},StarField.prototype._renderStarField=function(){var t,i;for(this.canvas.fillStyle="rgba(0, 0, 0, .5)",this.canvas.fillRect(0,0,this.width,this.height),t=0;t<this.numStars;t++)i=this.starField[t],this.canvas.fillStyle="rgba(255, 255, 255, "+i.opacity+")",this.canvas.fillRect(i.x+this.width/2,i.y+this.height/2,2,2)},StarField.prototype._renderFrame=function(t){var i=t-(this.prevFrameTime||0);window.requestAnimationFrame(this._renderFrame.bind(this)),(i>=30||!this.prevFrameTime)&&(this.prevFrameTime=t,this._updateStarField(),this._renderStarField())},StarField.prototype._adjustCanvasSize=function(t,i){this.width=this.canvasElem.width=t||this.container.offsetWidth,this.height=this.canvasElem.height=i||this.container.offsetHeight},StarField.prototype._watchCanvasSize=function(t){var i,e,a=t-(this.prevCheckTime||0);window.requestAnimationFrame(this._watchCanvasSize.bind(this)),(a>=333||!this.prevCheckTime)&&(this.prevCheckTime=t,i=this.container.offsetWidth,e=this.container.offsetHeight,(this.oldWidth!==i||this.oldHeight!==e)&&(this.oldWidth=i,this.oldHeight=e,this._adjustCanvasSize(i,e)))},StarField.prototype._initScene=function(){var t;for(t=0;t<this.numStars;t++)this.starField.push(StarFactory.getRandomStar(-this.width/2,-this.height/2,this.width,this.height,this.maxStarSpeed));window.requestAnimationFrame(this._renderFrame.bind(this)),window.requestAnimationFrame(this._watchCanvasSize.bind(this))},StarField.prototype.render=function(t,i){this.numStars=t||100,this.maxStarSpeed=i||3,this._initScene(this.numStars)}(function(){for(var t=0,i=["ms","moz","webkit","o"],e=0;e<i.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[i[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[e]+"CancelAnimationFrame"]||window[i[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i){var e=(new Date).getTime(),a=Math.max(0,16-(e-t)),n=window.setTimeout(function(){i(e+a)},a);return t=e+a,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}());var starField=new StarField("container").render(333,3);